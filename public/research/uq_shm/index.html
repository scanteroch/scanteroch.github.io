<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Probabilistic SHM | Sergio Cantero Chinchilla</title>
<meta name="keywords" content="">
<meta name="description" content="Introduction Structural health monitoring (SHM) usually encompasses the different stages that form a monitoring strategy, namely continuous monitoring, damage detection, damage localisation and characterisation. SHM also arguably addresses the prediction of the remaining useful life of a structure, which is part of what is known as Prognostics and Health Management given that it involves maintenance policy about when to carry out inspections or replace a part based on the actual condition of the structure (or condition-based maintenance).">
<meta name="author" content="Sergio Cantero Chinchilla">
<link rel="canonical" href="http://localhost:1313/research/uq_shm/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.4485b763977cc3e4662eef6f989e7545db37d8db129ceec3fad44406a8b41456.css" integrity="sha256-RIW3Y5d8w&#43;RmLu9vmJ51Rds32NsSnO7D&#43;tREBqi0FFY=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/research/uq_shm/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Probabilistic SHM" />
<meta property="og:description" content="Introduction Structural health monitoring (SHM) usually encompasses the different stages that form a monitoring strategy, namely continuous monitoring, damage detection, damage localisation and characterisation. SHM also arguably addresses the prediction of the remaining useful life of a structure, which is part of what is known as Prognostics and Health Management given that it involves maintenance policy about when to carry out inspections or replace a part based on the actual condition of the structure (or condition-based maintenance)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/research/uq_shm/" /><meta property="og:image" content="http://localhost:1313/papermod-cover.png"/><meta property="article:section" content="research" />



<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://localhost:1313/papermod-cover.png"/>

<meta name="twitter:title" content="Probabilistic SHM"/>
<meta name="twitter:description" content="Introduction Structural health monitoring (SHM) usually encompasses the different stages that form a monitoring strategy, namely continuous monitoring, damage detection, damage localisation and characterisation. SHM also arguably addresses the prediction of the remaining useful life of a structure, which is part of what is known as Prognostics and Health Management given that it involves maintenance policy about when to carry out inspections or replace a part based on the actual condition of the structure (or condition-based maintenance)."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Data-Driven Engineering lab - Research",
      "item": "http://localhost:1313/research/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Probabilistic SHM",
      "item": "http://localhost:1313/research/uq_shm/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Probabilistic SHM",
  "name": "Probabilistic SHM",
  "description": "Introduction Structural health monitoring (SHM) usually encompasses the different stages that form a monitoring strategy, namely continuous monitoring, damage detection, damage localisation and characterisation. SHM also arguably addresses the prediction of the remaining useful life of a structure, which is part of what is known as Prognostics and Health Management given that it involves maintenance policy about when to carry out inspections or replace a part based on the actual condition of the structure (or condition-based maintenance).",
  "keywords": [
    
  ],
  "articleBody": "Introduction Structural health monitoring (SHM) usually encompasses the different stages that form a monitoring strategy, namely continuous monitoring, damage detection, damage localisation and characterisation. SHM also arguably addresses the prediction of the remaining useful life of a structure, which is part of what is known as Prognostics and Health Management given that it involves maintenance policy about when to carry out inspections or replace a part based on the actual condition of the structure (or condition-based maintenance). The fundamental difference with respect to NDE is that SHM is performed continuously in time - i.e. there is a continuous monitoring of the structural health state.\nIn the condition-based maintenance paradigm, the quantification of uncertainties is crucial in order to make informed decisions based on probabilities. In this research line, I have developed Bayesian probabilistic methods to address all the stages of SHM. Furthermore, SHM can be carried out using a variety of testing techniques such as vibration methods, visual inspection methods or ultrasonic testing. The latter is particularly interesting for industries with high-value structures with thin-like structures such as the aerospace industries. Most of my work in this area is generic and transferrable to any other testing technique, but has been proved on ultrasonic guided-waves or through-transmission ultrasound - given its weight lightness, penetration power, low attenuation and cheap implementation costs.\nDamage detection This is probably the most important of all the SHM stages. Reliably and efficiently detecting incipient forms of damage is crucial to ensure safe operation of any engineering asset. Making a prompt decision about an indication of a defect is crucial and hard to perform on complex data such as guided waves. The approach I developed in this area [1] accounts for significant differences in the shape of guided-waves as a result of any external interaction with the structure. It uses fuzzy logic principles to provide information about the peaks of a signal being shifted by applying a probability density function like fuzzy set to each signal peak. This technique in itself may be prone to false negatives, but the potential lies in the use of massive sets of signals coming from different test configurations such as physical beamforming or full matrix capture. Moreover, one can use statistics to track the degradation of a structure and construct a degree of health indicator which can match the damage in itself as demonstrated in a fatigue test and shown in the figure below.\nDegree of Health (DoH) comparison against crack length in a fatigue test of an aluminium plate [1].\rDamage localisation Once damage is detected, the next stage in the SHM process is to locate it and isolate it in order to make decisions - e.g. if it falls within a safety-critical area, the part can be replaced without further investigation. Nonetheless, accounting for uncertainties in the process of signal processing is important given the differences in applying these techniques. For example, if a baseline extraction method is being applied, usually the arrival time of the first wave packet in the guided wave is extracted to tract the arrival time. An ellipse-based geometrical model can then be used to extract the damage location. The processing approach to extract the arrival time, e.g. through time-frequency transforms, inevitably introduces epistemic uncertainties stemming from mathematical assumptions when building such techniques. These uncertainties can be systematically accounted for when inferring the damage location. In fact, if the uncertainties of all processing models are added, one can make a hyper-robust estimation of the damage location, accounting for multiple uncertainties. This leads to more accurate and complete identification of damage locations as shown below in comparison with a deterministic optimisation method (genetic algorithms (GA)).\nComparison between a deterministic damage localization using GA (grey point) and the results obtained with the Bayesian approach [2].\rI have developed other Bayesian approaches for localising damage based on physics-based guided wave propagation models and others for resonant metamaterial beams, which you can check in my Scholar.\nDamage characterisation The next stage in the SHM ladder is to characterise the defect severity. This is usually through characterising the shape and type (e.g. crack of 3mm). To tackle this problem, I have developed multiple multilevel Bayesian approaches whereby the damage is quantified (e.g. Young’s modulus reduction) and characterised (e.g. how many layers in a composite layup are damaged). Depending on the nature of the problem, the problem of characterising the type of damage can be computationally expensive if many options can be considered; hence, computational strategies that avoid the calculation of every combination in a full-grid search are considered, such as greedy algorithms whereby only one entity (damage mode, sensor location, etc.) is considered at a time. This was proven computationally efficient when performing damage characterisation in post-impact fatigue composite specimens, whereby the damage pattern can be formed of any combination of layer and interface in the specimen.\nBayesian IP framework at the three hierarchical levels [3].\rThe multilevel Bayesian approach for inverse problems is a very powerful technique for inferring damage characteristics as long as a damage model is available that is not computationally very heavy to compute. This would require the use of a data-driven surrogate model and/or the use of approximate Bayesian methods to reduce the usage of the physics model itself. I have worked in multiple characterisation approaches in the context of probabilistic SHM, which you can check in my Scholar.\nResearch work The work in this area is nowadays driven by the integration of neural networks in the inverse problem - e.g. surrogate models of the physics models and surrogating the entire inversion process. Currently I am open to the development of any Bayesian methods that advance the state of the art through the use of scientific machine learning, surrogate models and neural networks. In addition, I am also currently working on extending the characterisation stage to the prognostics one, whereby the end-of-life of a structure can be predicted using degradation models. If you want to collaborate in any of these areas, do not hesitate to contact me.\nReferences Cantero-Chinchilla, S., Aranguren, G., Royo, J.M., Chiachío, M., Etxaniz, J. and Calvo-Echenique, A., 2021. Structural health monitoring using ultrasonic guided-waves and the degree of health index. Sensors, 21(3), p.993. Cantero-Chinchilla, S., Chiachío, J., Chiachío, M., Chronopoulos, D. and Jones, A., 2019. A robust Bayesian methodology for damage localization in plate-like structures using ultrasonic guided-waves. Mechanical Systems and Signal Processing, 122, pp.192-205. Chiachío, J., Bochud, N., Chiachío, M., Cantero, S. and Rus, G., 2017. A multilevel Bayesian method for ultrasound-based damage identification in composite laminates. Mechanical Systems and Signal Processing, 88, pp.462-477. ",
  "wordCount" : "1094",
  "inLanguage": "en",
  "datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Sergio Cantero Chinchilla"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/research/uq_shm/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Sergio Cantero Chinchilla",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Sergio Cantero Chinchilla (Alt + H)">Sergio Cantero Chinchilla</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/research/" title="Research">
                    <span>Research</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/people/" title="People">
                    <span>People</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/collaborators/" title="Collaborators">
                    <span>Collaborators</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/jobs/" title="Jobs &amp; Opportunities">
                    <span>Jobs &amp; Opportunities</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/research/">Data-Driven Engineering lab - Research</a></div>
    <h1 class="post-title">
      Probabilistic SHM
    </h1>
    <div class="post-meta">6 min&nbsp;·&nbsp;Sergio Cantero Chinchilla&nbsp;|&nbsp;<a href="https://github.com/scanteroch/scanteroch.github.io/scanteroch/content/research/UQ_SHM.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#damage-detection" aria-label="Damage detection">Damage detection</a></li>
                <li>
                    <a href="#damage-localisation" aria-label="Damage localisation">Damage localisation</a></li>
                <li>
                    <a href="#damage-characterisation" aria-label="Damage characterisation">Damage characterisation</a></li>
                <li>
                    <a href="#research-work" aria-label="Research work">Research work</a></li>
                <li>
                    <a href="#references" aria-label="References">References</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h1>
<p>Structural health monitoring (SHM) usually encompasses the different stages that form a monitoring strategy, namely continuous monitoring, damage detection, damage localisation and characterisation. SHM also arguably addresses the prediction of the remaining useful life of a structure, which is part of what is known as Prognostics and Health Management given that it involves maintenance policy about when to carry out inspections or replace a part based on the actual condition of the structure (or condition-based maintenance). The fundamental difference with respect to NDE is that SHM is performed continuously in time - i.e. there is a continuous monitoring of the structural health state.</p>
<p>In the condition-based maintenance paradigm, the quantification of uncertainties is crucial in order to make informed decisions based on probabilities. In this research line, I have developed Bayesian probabilistic methods to address all the stages of SHM. Furthermore, SHM can be carried out using a variety of testing techniques such as vibration methods, visual inspection methods or ultrasonic testing. The latter is particularly interesting for industries with high-value structures with thin-like structures such as the aerospace industries. Most of my work in this area is generic and transferrable to any other testing technique, but has been proved on ultrasonic guided-waves or through-transmission ultrasound - given its weight lightness, penetration power, low attenuation and cheap implementation costs.</p>
<h1 id="damage-detection">Damage detection<a hidden class="anchor" aria-hidden="true" href="#damage-detection">#</a></h1>
<p>This is probably the most important of all the SHM stages. Reliably and efficiently detecting incipient forms of damage is crucial to ensure safe operation of any engineering asset. Making a prompt decision about an indication of a defect is crucial and hard to perform on complex data such as guided waves. The approach I developed in this area [1] accounts for significant differences in the shape of guided-waves as a result of any external interaction with the structure. It uses fuzzy logic principles to provide information about the peaks of a signal being shifted by applying a probability density function like fuzzy set to each signal peak. This technique in itself may be prone to false negatives, but the potential lies in the use of massive sets of signals coming from different test configurations such as physical beamforming or full matrix capture. Moreover, one can use statistics to track the degradation of a structure and construct a degree of health indicator which can match the damage in itself as demonstrated in a fatigue test and shown in the figure below.</p>
<figure>
<img src="../media/DoH.png" alt="Degree of Health (DoH) comparison against crack length." style="width:500px;"/>
<figcaption>Degree of Health (DoH) comparison against crack length in a fatigue test of an aluminium plate [1].</figcaption>
</figure>
<h1 id="damage-localisation">Damage localisation<a hidden class="anchor" aria-hidden="true" href="#damage-localisation">#</a></h1>
<p>Once damage is detected, the next stage in the SHM process is to locate it and isolate it in order to make decisions - e.g. if it falls within a safety-critical area, the part can be replaced without further investigation. Nonetheless, accounting for uncertainties in the process of signal processing is important given the differences in applying these techniques. For example, if a baseline extraction method is being applied, usually the arrival time of the first wave packet in the guided wave is extracted to tract the arrival time. An ellipse-based geometrical model can then be used to extract the damage location. The processing approach to extract the arrival time, e.g. through time-frequency transforms, inevitably introduces epistemic uncertainties stemming from mathematical assumptions when building such techniques. These uncertainties can be systematically accounted for when inferring the damage location. In fact, if the uncertainties of all processing models are added, one can make a hyper-robust estimation of the damage location, accounting for multiple uncertainties. This leads to more accurate and complete identification of damage locations as shown below in comparison with a deterministic optimisation method (genetic algorithms (GA)).</p>
<figure>
<img src="../media/localisation.jpg" alt="Comparison between deterministic and Bayesian approaches" style="width:500px;"/>
<figcaption>Comparison between a deterministic damage localization using GA (grey point) and the results obtained with the Bayesian approach [2].</figcaption>
</figure>
<p>I have developed other Bayesian approaches for localising damage based on physics-based guided wave propagation models and others for resonant metamaterial beams, which you can check in my <a href="https://scholar.google.com/citations?user=UzQ8jtwAAAAJ&hl=en">Scholar</a>.</p>
<h1 id="damage-characterisation">Damage characterisation<a hidden class="anchor" aria-hidden="true" href="#damage-characterisation">#</a></h1>
<p>The next stage in the SHM ladder is to characterise the defect severity. This is usually through characterising the shape and type (e.g. crack of 3mm). To tackle this problem, I have developed multiple multilevel Bayesian approaches whereby the damage is quantified (e.g. Young&rsquo;s modulus reduction) and characterised (e.g. how many layers in a composite layup are damaged). Depending on the nature of the problem, the problem of characterising the type of damage can be computationally expensive if many options can be considered; hence, computational strategies that avoid the calculation of every combination in a full-grid search are considered, such as greedy algorithms whereby only one entity (damage mode, sensor location, etc.) is considered at a time. This was proven computationally efficient when performing damage characterisation in post-impact fatigue composite specimens, whereby the damage pattern can be formed of any combination of layer and interface in the specimen.</p>
<figure>
<img src="../media/Bayesian.jpg" alt=" Bayesian IP framework at the three hierarchical levels" style="width:500px;"/>
<figcaption>Bayesian IP framework at the three hierarchical levels [3].</figcaption>
</figure>
<p>The multilevel Bayesian approach for inverse problems is a very powerful technique for inferring damage characteristics as long as a damage model is available that is not computationally very heavy to compute. This would require the use of a data-driven surrogate model and/or the use of approximate Bayesian methods to reduce the usage of the physics model itself. I have worked in multiple characterisation approaches in the context of probabilistic SHM, which you can check in my <a href="https://scholar.google.com/citations?user=UzQ8jtwAAAAJ&hl=en">Scholar</a>.</p>
<h1 id="research-work">Research work<a hidden class="anchor" aria-hidden="true" href="#research-work">#</a></h1>
<p>The work in this area is nowadays driven by the integration of neural networks in the inverse problem - e.g. surrogate models of the physics models and surrogating the entire inversion process. Currently I am open to the development of any Bayesian methods that advance the state of the art through the use of scientific machine learning, surrogate models and neural networks. In addition, I am also currently working on extending the characterisation stage to the prognostics one, whereby the end-of-life of a structure can be predicted using degradation models. If you want to collaborate in any of these areas, do not hesitate to contact me.</p>
<h1 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h1>
<ol>
<li>Cantero-Chinchilla, S., Aranguren, G., Royo, J.M., Chiachío, M., Etxaniz, J. and Calvo-Echenique, A., 2021. Structural health monitoring using ultrasonic guided-waves and the degree of health index. <em>Sensors</em>, 21(3), p.993.</li>
<li>Cantero-Chinchilla, S., Chiachío, J., Chiachío, M., Chronopoulos, D. and Jones, A., 2019. A robust Bayesian methodology for damage localization in plate-like structures using ultrasonic guided-waves. <em>Mechanical Systems and Signal Processing</em>, 122, pp.192-205.</li>
<li>Chiachío, J., Bochud, N., Chiachío, M., Cantero, S. and Rus, G., 2017. A multilevel Bayesian method for ultrasound-based damage identification in composite laminates. <em>Mechanical Systems and Signal Processing</em>, 88, pp.462-477.</li>
</ol>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/research/alipa/">
    <span class="title">« Prev</span>
    <br>
    <span>Adaptive Laser-Induced Phased Array inspections</span>
  </a>
  <a class="next" href="http://localhost:1313/research/osp/">
    <span class="title">Next »</span>
    <br>
    <span>Optimal sensor placement</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="http://localhost:1313/">Sergio Cantero Chinchilla</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
